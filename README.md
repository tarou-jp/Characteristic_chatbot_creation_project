# キャラクター性を持つ言語モデルプロジェクト

## 概要
このプロジェクトは、言語モデルにキャラクター性を持たせることを目指した。言語モデルに名前、性格、知識を基にした一貫性のある応答能力を付与し、最終的にはユーザーと会話できるシステムを構築を行った。

## 特徴
- **キャラクター性**: 本プロジェクトで作成する言語モデルは、アニメキャラクターや実在した人物のキャラクター性を模倣する。

## アプローチ
本プロジェクトでは以下の二つのアプローチを採用した。
1. **How to Say (口調によるキャラクター性の付与)**: 言語モデルの話し方や口調を特定のキャラクター性を付与させる（例：〜ざます）。
2. **What to Say (話題によるキャラクター性の付与)**: キャラクターの記憶や性格を基にした話題をプロンプトを通じて実装することでキャラクター性を付与する。

## ディレクトリ説明
本ページでは、プロジェクト実装におけるソースコードの一部を置いている。使用したデータ等は含まれていません。

## システム概要図
![image](https://github.com/tarou-jp/Characteristic_chatbot_creation_project/assets/117962902/bbfe5b37-d846-456a-a322-fb2147cb63ad)

## システム説明
ユーザーの入力は二つの言語モデルを通して処理される。
最初のモデルは「埋め込みモデル」と呼ばれ、ユーザーの入力を特定の空間内のベクトルに変換する。
このベクトルは「llamaindex」というツールを使用して、データベース内のテキストと比較され、類似度が計算される。データベースには、キャラクターに関する情報（親族の名前や、その人生での経験などのテキスト）が含まれている。ユーザーの入力と類似度の高いテキストが検索結果として次の言語モデルに送信される。検索結果を受け取る言語モデルは「Use Gate」と名付けた。このモデルは、検索結果がユーザーの質問に対する回答の形成に有用であるかどうかを評価し、有用と判断された場合のみプロンプトに挿入される。
このゲートを設ける理由は、単に類似度が高いテキストを選出するだけでは、キャラクター情報が不要な単純な入力であってもテキストがプロンプトに挿入されてしまうことを防ぐためである。また、類似度が最も高いテキストが必ずしも求める情報であるとは限らないため、類似度が高いテキストを三つ検索し、その中から最も有用なものを選択することで、より精度高く必要な情報を取得できるようになっている。

ユーザーの入力を受け取る二つ目の言語モデルは「topic determine」と名付けた、この言語モデルは、ユーザーとの会話におけるトピックを特定する役割を担う。例えば、ユーザーと言語モデルが音楽について話している場合、このモデルは「music」というトピックを特定する。このトピックを基に、データベースからユーザーとの過去の会話の要約文が検索される。この検索では、直近の会話の要約、過去に頻繁に参照された要約が優先される。これは人間の長期記憶を模倣した機能である。この検索結果はプロンプトに挿入され、言語モデルがキャラクターに関する情報や、過去の会話の内容を基に会話を進めることが可能になる。

これらのプロセスにより、言語モデルはキャラクターが持つ知識や記憶に基づいたより豊かで関連性の高い会話を行うこと可能となる。

## 使用例
![image](https://github.com/tarou-jp/Characteristic_chatbot_creation_project/assets/117962902/a1eb960b-f8aa-48b5-aba9-dbfa0971f148)
![image](https://github.com/tarou-jp/Characteristic_chatbot_creation_project/assets/117962902/6dac9843-0dec-41cb-b5cc-704c801bc25a)


## 使用技術
- Python
- Flask
- HTML
- CSS
- Open-NMT

## 習得した技術
- 言語モデルを学習させるためのデータ用意、データ処理の技術
- flaskを用いたweb開発
- Open-NMTを用いた言語モデルの作成
